{
  "name": "rowy-run-manager",
  "env": {
    "ROWY_SECRET": {
      "generator": "secret"
    }
  },
  "options": {
    "allow-unauthenticated": true,
    "memory": "1Gi"
  },

  "hooks": {
    "prebuild": {
      "commands": [
        "apt-get install unzip -y",
        "wget https://releases.hashicorp.com/terraform/1.0.11/terraform_1.0.11_linux_amd64.zip",
        "unzip terraform_1.0.11_linux_amd64.zip",
        "mv terraform /usr/local/bin/",
        "terraform --version",
        "npm install",
        "npm run build",
        "node build/hooks/initTerraformStateBucket"
      ]
    },
    "postbuild":{
      "commands": [
        "node build/hooks/initFirestore"
      ]
    }
  }
}
